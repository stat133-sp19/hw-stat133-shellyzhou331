x <- mixture_data$x
z <- mixture_data$z
plot_data(x, z)
knitr::opts_chunk$set(echo = TRUE)
#Function to Generate Data
library(MASS)
library(ggplot2)
gen_mixture_data <- function(probs, mus, sigs, N){
num_points <- table(sample(1:K, prob = probs, size = N, replace = TRUE))
x <- matrix(, nrow = 0, ncol = 2)
z <- c()
for (k in 1:K) {
x <- rbind(x, mvrnorm(num_points[k], mus[k, ], sigs[, , k]))
z <- c(z, rep(k, num_points[k]))
}
return(list("x" = x, "z" = z))
}
#Function to Plot
colors <- c("red", "green", "blue")
plot_data <- function(x, z){
ggplot() + geom_point(aes(x = x[, 1], y = x[, 2], col = colors[z])) + labs(x = "X1", y = "X2")
}
#Input the data
N <- 1000
K <- 2
probs <- c(0.5, 0.5)
mus <- matrix(c(0, 0, 1, 0), 2, 2, byrow = TRUE)
vars <- c(1, 4, 1)
sigs <- array(rep(NA, 2*2*K), c(2, 2, K)) #3D Matrix
#with covariance
sigs[, , 1] <- matrix(c(1, 0, 0, 1), nrow = 2, byrow = TRUE)
sigs[, , 2] <- matrix(c(1, 0, 0, 4), nrow = 2, byrow = TRUE)
mixture_data <- gen_mixture_data(probs, mus, sigs, N)
x <- mixture_data$x
z <- mixture_data$z
plot_data(x, z)
#K-Mean analysis -- From code in lab-04
kmeans_analysis <- function(x, z, mus, K=3){
cl <- kmeans(x, K, nstart = 25)
z_km <- cl$cluster
show(cl$centers)
show(mus)
dev.new(width = 4, height = 4)
ggplot() + geom_point(aes(x = x[, 1], y = x[, 2], col = colors[z_km])) + labs(x = "X1", y = "X2") + geom_point(aes(x = cl$centers[, 1], y = cl$centers[, 2]), shape = 15, size = 4) + geom_point(aes(x = mus[, 1], y = mus[, 2]), shape = 18, size = 4) #see how close it is to the real mean
}
kmeans_analysis(x, z, mus, 2)
#A package to do EM Algorithm
library(mclust)
model <- Mclust(x, G = 2)
summary(model)
z_em <- apply(model$z, 1, which.max)
em_means <- model$parameters$mean
ggplot() + geom_point(aes(x = x[, 1], y = x[, 2], col = colors[z_em])) + labs(x = "X1", y = "X2") + geom_point(aes(x = em_means[1, ], y = em_means[2, ]), shape = 15, size = 4) + geom_point(aes(x = mus[, 1], y = mus[, 2]), shape = 18, size = 4) #see how close it is to the real mean
labs(title = "EM")
plot_data(x, z)
kmeans_analysis(x, z, mus, 2)
ggplot() + geom_point(aes(x = x[, 1], y = x[, 2], col = colors[z_em])) + labs(x = "X1", y = "X2") + geom_point(aes(x = em_means[1, ], y = em_means[2, ]), shape = 15, size = 4) + geom_point(aes(x = mus[, 1], y = mus[, 2]), shape = 18, size = 4) #see how close it is to the real mean
labs(title = "EM")
load(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
load(ggplot2)
library(ggplot2)
load(ggplot2)
## title :
##
iguodala <- read.csv("../data/andre-iguodala.csv", stringsAsFactors = FALSE)
green <- read.csv("../data/draymond-green.csv", stringsAsFactors = FALSE)
durant <- read.csv("../data/kevin-durant.csv", stringsAsFactors = FALSE)
thompson <- read.csv("../data/klay-thompson.csv", stringsAsFactors = FALSE)
curry <- read.csv("../data/stephen-curry.csv", stringsAsFactors = FALSE)
iguodala$name <- rep("Andre Iguodala", length(iguodala$team_name))
green$name <- rep("Draymond Green", length(green$team_name))
durant$name <- rep("Kevin Durant", length(durant$team_name))
thompson$name <- rep("Klay Thompson", length(thompson$team_name))
curry$name <- rep("Stephen Curry", length(curry$team_name))
iguodala <- read.csv("../data/andre-iguodala.csv", stringsAsFactors = FALSE)
green <- read.csv("../data/draymond-green.csv", stringsAsFactors = FALSE)
durant <- read.csv("../data/kevin-durant.csv", stringsAsFactors = FALSE)
thompson <- read.csv("../data/klay-thompson.csv", stringsAsFactors = FALSE)
curry <- read.csv("../data/stephen-curry.csv", stringsAsFactors = FALSE)
iguodala <- read.csv("../data/andre-iguodala.csv", stringsAsFactors = FALSE)
curry <- read.csv("../data/stephen-curry.csv", stringsAsFactors = FALSE)
iguodala <- read.csv('../data/andre-iguodala.csv', stringsAsFactors = FALSE)
iguodala <- read.csv('data/andre-iguodala.csv', stringsAsFactors = FALSE)
?read.csv
getwd()
setwd("C:/Berkeley/Stat-133/Workout/workout01/code")
iguodala <- read.csv('../data/andre-iguodala.csv', stringsAsFactors = FALSE)
green <- read.csv("../data/draymond-green.csv", stringsAsFactors = FALSE)
durant <- read.csv("../data/kevin-durant.csv", stringsAsFactors = FALSE)
thompson <- read.csv("../data/klay-thompson.csv", stringsAsFactors = FALSE)
curry <- read.csv("../data/stephen-curry.csv", stringsAsFactors = FALSE)
iguodala$name <- rep("Andre Iguodala", length(iguodala$team_name))
green$name <- rep("Draymond Green", length(green$team_name))
durant$name <- rep("Kevin Durant", length(durant$team_name))
thompson$name <- rep("Klay Thompson", length(thompson$team_name))
curry$name <- rep("Stephen Curry", length(curry$team_name))
iguodala$shot_made_flag[iguodala$shot_made_flag == "n"] <- "shot_no"
iguodala$shot_made_flag[iguodala$shot_made_flag == "y"] <- "shot_yes"
green$shot_made_flag[iguodala$shot_made_flag == "n"] <- "shot_no"
green$shot_made_flag[iguodala$shot_made_flag == "y"] <- "shot_yes"
durant$shot_made_flag[iguodala$shot_made_flag == "n"] <- "shot_no"
durant$shot_made_flag[iguodala$shot_made_flag == "y"] <- "shot_yes"
thompson$shot_made_flag[iguodala$shot_made_flag == "n"] <- "shot_no"
thompson$shot_made_flag[iguodala$shot_made_flag == "y"] <- "shot_yes"
curry$shot_made_flag[iguodala$shot_made_flag == "n"] <- "shot_no"
curry$shot_made_flag[iguodala$shot_made_flag == "y"] <- "shot_yes"
iguodala$minute <- iguodala$period*12 - iguodala$minutes_remaining
green$minute <- iguodala$period*12 - iguodala$minutes_remaining
durant$minute <- iguodala$period*12 - iguodala$minutes_remaining
thompson$minute <- iguodala$period*12 - iguodala$minutes_remaining
curry$minute <- iguodala$period*12 - iguodala$minutes_remaining
iguodala$minute <- iguodala$period*12 - iguodala$minutes_remaining
green$minute <- green$period*12 - green$minutes_remaining
durant$minute <- durant$period*12 - durant$minutes_remaining
thompson$minute <- thompson$period*12 - thompson$minutes_remaining
curry$minute <- curry$period*12 - curry$minutes_remaining
## Use sink to send files
sink(file = '../output/andre-iguodala-summary.txt')
summary(iguodala)
# closing sinking operation
sink()
sink(file = '../output/draymond-green-summary.txt')
summary(green)
# closing sinking operation
sink()
sink(file = '../output/kevin-durant-summary.txt')
summary(durant)
# closing sinking operation
sink()
sink(file = '../output/klay-thompson-summary.txt')
summary(thompson)
# closing sinking operation
sink()
sink(file = '../output/stephen-curry-summary.txt')
summary(curry)
# closing sinking operation
sink()
sink(file = '../data/shots-data.csv')
rbind(summary(iguodala), summary(green), summary(durant), summary(thompson), summary(curry))
# closing sinking operation
sink()
sink(file = '../output/shots-data-summary.txt')
summary(rbind(summary(iguodala), summary(green), summary(durant), summary(thompson), summary(curry)))
# closing sinking operation
sink()
install.packages("jpeg")
install.packages("grid")
getwd()
court_file <- "../images/nba-court.jpg"
# create raste object
court_image <- rasterGrob(
readJPEG(court_file),
width = unit(1, "npc"),
height = unit(1, "npc"))
library(jpeg)
library(grid)
court_file <- "../images/nba-court.jpg"
# create raste object
court_image <- rasterGrob(
readJPEG(court_file),
width = unit(1, "npc"),
height = unit(1, "npc"))
thompson_shot_chart <- ggplot(data = thompson) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
# shot chart with court background
iguodala_shot_chart <- ggplot(data = iguodala) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
# shot chart with court background
green_shot_chart <- ggplot(data = green) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
# shot chart with court background
durant_shot_chart <- ggplot(data = durant) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
# shot chart with court background
curry_shot_chart <- ggplot(data = curry) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
library(ggplot2)
thompson_shot_chart <- ggplot(data = thompson) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
# shot chart with court background
iguodala_shot_chart <- ggplot(data = iguodala) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
# shot chart with court background
green_shot_chart <- ggplot(data = green) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
# shot chart with court background
durant_shot_chart <- ggplot(data = durant) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
# shot chart with court background
curry_shot_chart <- ggplot(data = curry) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
thompson_shot_chart <- ggplot(data = thompson) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
ggsave(filename = "../images/klay-thompson-shot-chart.pdf", width = 6.5, height = 5)
iguodala_shot_chart <- ggplot(data = iguodala) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
ggsave(filename = "../images/andre-iguodala-shot-chart.pdf", width = 6.5, height = 5)
thompson_shot_chart <- ggplot(data = thompson) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
ggsave(filename = "../images/klay-thompson-shot-chart.pdf", width = 6.5, height = 5)
# shot chart with court background
iguodala_shot_chart <- ggplot(data = iguodala) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Andre Iguodala (2016 season)') +
theme_minimal()
ggsave(filename = "../images/andre-iguodala-shot-chart.pdf", width = 6.5, height = 5)
# shot chart with court background
green_shot_chart <- ggplot(data = green) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Draymond Green (2016 season)') +
theme_minimal()
ggsave(filename = "../images/draymond-green-shot-chart.pdf", width = 6.5, height = 5)
# shot chart with court background
durant_shot_chart <- ggplot(data = durant) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Kevin Durant (2016 season)') +
theme_minimal()
ggsave(filename = "../images/kevin-durant-shot-chart.pdf", width = 6.5, height = 5)
# shot chart with court background
curry_shot_chart <- ggplot(data = curry) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Stephen Curry (2016 season)') +
theme_minimal()
ggsave(filename = "../images/stephen-curry-shot-chart.pdf", width = 6.5, height = 5)
## The big shot chart
total_data <- rbind(iguodala, green, thompson, durant, curry)
all_shot_chart <- ggplot(data = total_data) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Charts: GSW (2016 season)') +
theme_minimal() + facet_wrap(~name)
ggsave(filename = "../images/gsw-shot-charts.pdf", width = 8, height = 7)
## title :
## description:
## inputs:
## outputs:
## Read the files
getwd()
setwd("C:/Berkeley/Stat-133/Workout/workout01/code")
iguodala <- read.csv('../data/andre-iguodala.csv', stringsAsFactors = FALSE)
green <- read.csv("../data/draymond-green.csv", stringsAsFactors = FALSE)
durant <- read.csv("../data/kevin-durant.csv", stringsAsFactors = FALSE)
thompson <- read.csv("../data/klay-thompson.csv", stringsAsFactors = FALSE)
curry <- read.csv("../data/stephen-curry.csv", stringsAsFactors = FALSE)
##Add the name column to each data file
iguodala$name <- rep("Andre Iguodala", length(iguodala$team_name))
green$name <- rep("Draymond Green", length(green$team_name))
durant$name <- rep("Kevin Durant", length(durant$team_name))
thompson$name <- rep("Klay Thompson", length(thompson$team_name))
curry$name <- rep("Stephen Curry", length(curry$team_name))
## Make shot_made_flag more informative
iguodala$shot_made_flag[iguodala$shot_made_flag == "n"] <- "shot_no"
iguodala$shot_made_flag[iguodala$shot_made_flag == "y"] <- "shot_yes"
green$shot_made_flag[green$shot_made_flag == "n"] <- "shot_no"
green$shot_made_flag[green$shot_made_flag == "y"] <- "shot_yes"
durant$shot_made_flag[durant$shot_made_flag == "n"] <- "shot_no"
durant$shot_made_flag[durant$shot_made_flag == "y"] <- "shot_yes"
thompson$shot_made_flag[thompson$shot_made_flag == "n"] <- "shot_no"
thompson$shot_made_flag[thompson$shot_made_flag == "y"] <- "shot_yes"
curry$shot_made_flag[curry$shot_made_flag == "n"] <- "shot_no"
curry$shot_made_flag[curry$shot_made_flag == "y"] <- "shot_yes"
## Add the minute columns to each data set
iguodala$minute <- iguodala$period*12 - iguodala$minutes_remaining
green$minute <- green$period*12 - green$minutes_remaining
durant$minute <- durant$period*12 - durant$minutes_remaining
thompson$minute <- thompson$period*12 - thompson$minutes_remaining
curry$minute <- curry$period*12 - curry$minutes_remaining
## Use sink to send files
sink(file = '../output/andre-iguodala-summary.txt')
summary(iguodala)
# closing sinking operation
sink()
sink(file = '../output/draymond-green-summary.txt')
summary(green)
# closing sinking operation
sink()
sink(file = '../output/kevin-durant-summary.txt')
summary(durant)
# closing sinking operation
sink()
sink(file = '../output/klay-thompson-summary.txt')
summary(thompson)
# closing sinking operation
sink()
sink(file = '../output/stephen-curry-summary.txt')
summary(curry)
# closing sinking operation
sink()
## Write shots-data.csv and export
sink(file = '../data/shots-data.csv')
rbind(summary(iguodala), summary(green), summary(durant), summary(thompson), summary(curry))
# closing sinking operation
sink()
sink(file = '../output/shots-data-summary.txt')
summary(rbind(summary(iguodala), summary(green), summary(durant), summary(thompson), summary(curry)))
# closing sinking operation
sink()
## Add the image as background
library(jpeg)
## title:
## Description:
## Input: Datasets contain every players shot informtion
## Output:
## Add the image as background
library(jpeg)
library(grid)
library(ggplot2)
getwd()
# court image (to be used as background of plot)
court_file <- "../images/nba-court.jpg"
# create raste object
court_image <- rasterGrob(
readJPEG(court_file),
width = unit(1, "npc"),
height = unit(1, "npc"))
## Shot Charts
# shot chart with court background
thompson_shot_chart <- ggplot(data = thompson) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Klay Thompson (2016 season)') +
theme_minimal()
ggsave(filename = "../images/klay-thompson-shot-chart.pdf", width = 6.5, height = 5)
# shot chart with court background
iguodala_shot_chart <- ggplot(data = iguodala) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Andre Iguodala (2016 season)') +
theme_minimal()
ggsave(filename = "../images/andre-iguodala-shot-chart.pdf", width = 6.5, height = 5)
# shot chart with court background
green_shot_chart <- ggplot(data = green) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Draymond Green (2016 season)') +
theme_minimal()
ggsave(filename = "../images/draymond-green-shot-chart.pdf", width = 6.5, height = 5)
# shot chart with court background
durant_shot_chart <- ggplot(data = durant) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Kevin Durant (2016 season)') +
theme_minimal()
ggsave(filename = "../images/kevin-durant-shot-chart.pdf", width = 6.5, height = 5)
# shot chart with court background
curry_shot_chart <- ggplot(data = curry) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Chart: Stephen Curry (2016 season)') +
theme_minimal()
ggsave(filename = "../images/stephen-curry-shot-chart.pdf", width = 6.5, height = 5)
## The big shot chart
total_data <- rbind(iguodala, green, thompson, durant, curry)
all_shot_chart <- ggplot(data = total_data) +
annotation_custom(court_image, -250, 250, -50, 420) +
geom_point(aes(x = x, y = y, color = shot_made_flag)) +
ylim(-50, 420) +
ggtitle('Shot Charts: GSW (2016 season)') +
theme_minimal() + facet_wrap(~name)
ggsave(filename = "../images/gsw-shot-charts.pdf", width = 8, height = 7)
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(readr)
shots_data <- readr::read_csv("../data/shots-data.csv")
shots_data
## Write shots-data.csv and export
sink(file = '../data/shots-data.csv')
rbind(iguodala, green, durant, thompson, curry)
# closing sinking operation
sink()
sink(file = '../output/shots-data-summary.txt')
summary(rbind(iguodala, green, durant, thompson, curry))
# closing sinking operation
sink()
library(readr)
shots_data <- readr::read_csv("../data/shots-data.csv")
shots_data
?sink
sink(file = '../data/shots-data.csv', type = "output")
rbind(iguodala, green, durant, thompson, curry)
# closing sinking operation
sink()
sink(file = '../data/shots-data.csv', type = "message")
rbind(iguodala, green, durant, thompson, curry)
# closing sinking operation
sink()
head(green)
library(readr)
shots_data <- readr::read_csv("../data/shots-data.csv")
shots_data
head(rbind(iguodala, green, curry, durant, thompson))
total_shots <- rbind(iguodala, green, durant, thompson, curry)
sink(file = '../data/shots-data.csv')
total_shots
# closing sinking operation
sink()
shots_data <- readr::read_csv("../data/shots-data.csv")
shots_data
shots_data <- read_csv("../data/shots-data.csv")
shots_data
head(total_shots)
## Write shots-data.csv and export
write.csv(
total_shots <- rbind(iguodala, green, curry, durant, thompson), # R object to be exported
file = '../data/shots-data.csv'  # file path
)
sink(file = '../output/shots-data-summary.txt')
summary(rbind(iguodala, green, durant, thompson, curry))
# closing sinking operation
sink()
shots_data <- readr::read_csv("../data/shots-data.csv")
shots_data
shots_data <- readr::read_csv("../data/shots-data.csv")
shots_data
#2-point field goal
library(dplyr)
twopoint <- shots_data[shots_data$shot_type = "2PT Field Goal", c("name", "shot_made_flag")] %>% group_by(name) %>% summarise(total = n(), made = sum(shot_made_flag == shot_yes))
#2-point field goal
library(dplyr)
twopoint <- shots_data[shots_data$shot_type == "2PT Field Goal", c("name", "shot_made_flag")] %>% group_by(name) %>% summarise(total = n(), made = sum(shot_made_flag == shot_yes))
#2-point field goal
library(dplyr)
twopoint <- shots_data[shots_data$shot_type == "2PT Field Goal", c("name", "shot_made_flag")] %>% group_by(name) %>% summarise(total = n(), made = sum(shot_made_flag == "shot_yes"))
twopoint
#2-point field goal
library(dplyr)
twopoint <- shots_data[shots_data$shot_type == "2PT Field Goal", c("name", "shot_made_flag")] %>% group_by(name) %>% summarise(total = n(), made = sum(shot_made_flag == "shot_yes")) %>% mutate(perc_made = made/total)
twopoint
#2-point field goal
library(dplyr)
twopoint <- shots_data[shots_data$shot_type == "2PT Field Goal", c("name", "shot_made_flag")] %>% group_by(name) %>% summarise(total = n(), made = sum(shot_made_flag == "shot_yes")) %>% mutate(perc_made = made/total) %>% arrange(desc(perc_made))
twopoint
#3-point field goal
threepoint <- shots_data[shots_data$shot_type == "3PT Field Goal", c("name", "shot_made_flag")] %>% group_by(name) %>% summarise(total = n(), made = sum(shot_made_flag == "shot_yes")) %>% mutate(perc_made = made/total) %>% arrange(desc(perc_made))
threepoint
#Overall field goal
allpoint <- shots_data[ , c("name", "shot_made_flag")] %>% group_by(name) %>% summarise(total = n(), made = sum(shot_made_flag == "shot_yes")) %>% mutate(perc_made = made/total) %>% arrange(desc(perc_made))
allpoint
library(knitr)
knitr::include_graphics("../images/gsw-shot-charts.pdf")
getwd()
?include_graphics
library(knitr)
include_graphics("gsw-shot-charts.pdf")
ggsave(filename = "../images/gsw-shot-charts.png", width = 8, height = 7)
